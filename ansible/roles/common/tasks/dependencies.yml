---
- name: install dependencies
  become: yes
  apt:
    update_cache: yes
    state: present
    name:
      - at
      - bc
      - cmake
      - ffmpeg
      - gmic
      - gnuradio
      - gr-osmosdr
      - imagemagick
      - jq
      - libatlas-base-dev
      - libjpeg9
      - libjpeg9-dev
      - libncurses5-dev
      - libncursesw5-dev
      - libsox-fmt-mp3
      - libusb-1.0-0
      - libusb-1.0-0-dev
      - libxft-dev
      - libxft2
      - python3-pip
      - python-setuptools
      - socat
      - sox
      - sqlite3

- name: install dependencies (stretch only)
  become: yes
  apt:
    update_cache: no
    state: present
    name:
      - libgfortran-5-dev
      - predict
  when: ansible_distribution_release == 'stretch'

- name: install dependencies (non-stretch)
  become: yes
  apt:
    update_cache: no
    state: present
    name: libgfortran5
  when: ansible_distribution_release != 'stretch'

- name: install wkhtmltox (wkhtmltoimg) arm
  become: yes
  apt:
    deb: "https://github.com/wkhtmltopdf/packaging/releases/download/0.12.6-1/wkhtmltox_0.12.6-1.raspberrypi.{{ ansible_distribution_release }}_armhf.deb"
    state: present
  when: ansible_architecture == 'armv7l'

- name: install wkhtmltox (wkhtmltoimg) x86_64
  become: yes
  apt:
    deb: "https://github.com/wkhtmltopdf/packaging/releases/download/0.12.6-1/wkhtmltox_0.12.6-1.{{ ansible_distribution_release }}_amd64.deb"
    state: present
  when: ansible_architecture == 'x86_64'

# predict is not packaged anymore after stretch
- name: install predict (>stretch) x86_64
  become: yes
  apt:
    deb: "http://ftp.us.debian.org/debian/pool/main/p/predict/predict_2.2.3-4+b2_amd64.deb"
    state: present
  when:
    - ansible_distribution_release != 'stretch'
    - ansible_architecture == 'x86_64'

- name: install predict (>stretch) arm
  become: yes
  apt:
    deb: "http://ftp.us.debian.org/debian/pool/main/p/predict/predict_2.2.3-4+b2_armhf.deb"
    state: present
  when:
    - ansible_distribution_release != 'stretch'
    - ansible_architecture == 'armv7l'
